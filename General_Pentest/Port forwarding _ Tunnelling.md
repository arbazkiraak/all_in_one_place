Port forwarding / Tunnelling 

## Examples

### Local Port Forwarding

- Victime machine with two interfaces :
1. 172.16.1.1:9200 is unaccessible from our attacker machine and is http. We want to access it.
2. 10.10.10.200 is accessible from our attacker machine.
- Our attacker machine : 10.10.10.1
- On attacking machine : ```ssh -L localPort:targetIp:targetPort user@sshGateway```. So we have : ```ssh -f -N -L 9200:172.16.1.1:80 bryan@10.10.10.200```
- `-f` background the ssh process once it's authenticated
- `-N` doesn't run a particular command on the remote server.
- Now, you can access to the service via ```localhost:80```
- Here the listener process is on the victim machine.
- So here, you initiate the connecion from your attacker machine.

---

### Remote port forwarding :

### Deleted this part, have to write it properly 

---

### Dynamic port forwarding

### Deleted this part, have to write it properly 

**concrete scenario :**

- open port 8080

- modify proxychains conf : 
```
vim /etc/proxychains.conf
socks4 127.0.0.1 8080
```

- On compromised machine
```
ssh -f -N -R 2222:127.0.0.1:22 t0@10.11.0.156
(my password)
```

- Localy :
```
ssh -f -N -D 127.0.0.1:8080 -p 2222 root@127.0.0.1
(root password of the compromised machine)
```

```proxychains nmap``` ...

- Pay attention, nmap with proxychains is very limited.

---

### HTTP Tunneling 


---

## Tunnelling on windows xp :

- install ipv6 protocol on the network card via control panel

- then verify ```ip helper``` is installed

- ```netsh interface portproxy add v4tov4 listenport=<PORT> listenaddress=0.0.0.0 or 127.0.0.1 or realip connectport=<PORTTOCONNECT> connectaddress=<IPTOCONNECT>```

---

## Experiment this for dynamic part :


TRY SSHUTTLE : 

https://blog.notso.pro/2019-10-24-tactical-debriefing1/ 

---

## Quick remote port forwarding in an ssh session :

```
~C
hit enter
-R 8000:127.0.0.1:8000
```

